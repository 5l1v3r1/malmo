digraph ClientState {
    WAITING_FOR_MOD_READY -> DORMANT;
	DORMANT -> CREATING_HANDLERS;
	CREATING_HANDLERS -> EVALUATING_WORLD_REQUIREMENTS;
	CREATING_HANDLERS -> WAITING_FOR_SERVER_READY;
	EVALUATING_WORLD_REQUIREMENTS -> PAUSING_OLD_SERVER;
	EVALUATING_WORLD_REQUIREMENTS -> CREATING_NEW_WORLD;
    EVALUATING_WORLD_REQUIREMENTS -> WAITING_FOR_SERVER_READY;
	PAUSING_OLD_SERVER -> CLOSING_OLD_SERVER;
	CLOSING_OLD_SERVER -> CREATING_NEW_WORLD;
	CREATING_NEW_WORLD -> WAITING_FOR_SERVER_READY;
    WAITING_FOR_SERVER_READY -> RUNNING;
    RUNNING -> MISSION_ENDED;
    RUNNING -> IDLING;
	IDLING -> MISSION_ENDED;
	MISSION_ENDED -> DORMANT;
    MISSION_ENDED -> WAITING_FOR_SERVER_MISSION_END;
	MISSION_ABORTED -> DORMANT;
	WAITING_FOR_SERVER_MISSION_END -> DORMANT;
    subgraph ErrorStates {
        rank = min;
        node [shape=box, style=filled, color="#FFDDDD"];
        ERROR_DUFF_HANDLERS [label="Duff\nhandlers"];
        ERROR_INTEGRATED_SERVER_UNREACHABLE [label="Server\nunreachable"];
        ERROR_NO_WORLD [label="No world"];
        ERROR_CANNOT_CREATE_WORLD [label="Can't create\nworld"];
        ERROR_CANNOT_START_AGENT [label="Can't start\nagent"];
        ERROR_LOST_NETWORK_CONNECTION [label="Lost network\nconnection"];
        ERROR_CANNOT_CONNECT_TO_SERVER [label="Can't connect\nto server"];
        ERROR_LOST_AGENT [label="Lost contact\nwith agent"];
    }
    ERROR_DUFF_HANDLERS -> DORMANT;
    ERROR_INTEGRATED_SERVER_UNREACHABLE -> DORMANT;
    ERROR_NO_WORLD -> DORMANT;
    ERROR_CANNOT_CREATE_WORLD -> DORMANT;
    ERROR_CANNOT_START_AGENT -> DORMANT;
    ERROR_LOST_NETWORK_CONNECTION -> DORMANT;
    ERROR_CANNOT_CONNECT_TO_SERVER -> DORMANT;
    ERROR_LOST_AGENT -> DORMANT;
    edge [color=red];
	CREATING_HANDLERS -> MISSION_ABORTED;
	EVALUATING_WORLD_REQUIREMENTS -> ERROR_DUFF_HANDLERS;
    EVALUATING_WORLD_REQUIREMENTS -> ERROR_INTEGRATED_SERVER_UNREACHABLE;
    EVALUATING_WORLD_REQUIREMENTS -> ERROR_NO_WORLD;
	PAUSING_OLD_SERVER -> ERROR_CANNOT_CREATE_WORLD;
	PAUSING_OLD_SERVER -> MISSION_ABORTED;
	CLOSING_OLD_SERVER -> MISSION_ABORTED;
    CREATING_NEW_WORLD -> ERROR_CANNOT_CREATE_WORLD;
	WAITING_FOR_SERVER_READY -> MISSION_ABORTED;
    WAITING_FOR_SERVER_READY -> ERROR_CANNOT_CONNECT_TO_SERVER;
    WAITING_FOR_SERVER_READY -> ERROR_CANNOT_START_AGENT;
    WAITING_FOR_SERVER_READY -> ERROR_LOST_AGENT;
    RUNNING -> MISSION_ABORTED;
    RUNNING -> ERROR_LOST_NETWORK_CONNECTION;
    RUNNING -> ERROR_LOST_AGENT;
	WAITING_FOR_SERVER_MISSION_END -> MISSION_ABORTED;
}